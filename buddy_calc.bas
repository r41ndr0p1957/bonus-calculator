Attribute VB_Name = "Module1"
Sub SumWithComplexConditions()
    Dim wsData As Worksheet
    Dim wsResult As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim totalSum As Double
    Dim searchString As String
    
    ' ????????????? ??????? ?????
    Set wsData = ThisWorkbook.Worksheets("Задание 1")
    Set wsResult = ThisWorkbook.Worksheets("Задание ")
    
    ' ??????? ????????? ????????
    searchString = "Buddy"
    
    ' ?????????? ????????? ?????? ? ??????? AD
    lastRow = wsData.Cells(wsData.Rows.Count, "AD").End(xlUp).Row
    
    ' ?????????????? ?????
    totalSum = 0
    
    ' ???????? ???? ????????? ??????
    For i = 2 To lastRow ' ???????? ?? ?????? ?????? (???????????? ?????????)
        
        ' ????????? ?????? ???????: ??????? "Buddy" ? ??????? J
        Dim containsBuddy As Boolean
        containsBuddy = InStr(1, wsData.Cells(i, "J").Value, searchString, vbTextCompare) > 0
        
        ' ????????? ?????? ???????: ???????? ? ??????? V
        Dim validShift As Boolean
        validShift = False
        Select Case wsData.Cells(i, "V").Value
            Case "?????. ????????", "?????. ???", "?????. ?????????", "??????? ?????"
                validShift = True
        End Select
        
        ' ???? ??? ??????? ?????????
        If containsBuddy And validShift Then
            ' ????????? ? ????????? ???????? ????????
            If IsNumeric(wsData.Cells(i, "AD").Value) Then
                totalSum = totalSum + wsData.Cells(i, "AD").Value
            End If
        End If
    Next i
    
    ' ?????????? ?????????
    wsResult.Range("A1").Value = totalSum
    MsgBox "?????: " & totalSum & vbCrLf & "????????? ??????? ? A1 ????? '?????????'"
End Sub
